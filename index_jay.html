<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CoronaEscape</title>
    <meta name="description" content="CoronaEscape">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="js/realchair.js"></script>
  </head>
  <body>
    <a-scene background="color: #ECECEC" physics="debug: true; gravity: 0">
        <a-assets>
          <a-asset-item id="house-gltf" src="./apartment-living-room-obj/apartment-living-room.gltf"></a-asset-item>
          <a-asset-item id="chair-gltf" src="./models/armchair.gltf"></a-asset-item>
        </a-assets>
        
        <a-entity gltf-model="#house-gltf" modify-materials></a-entity>
        <a-box static-body="shape: auto" position="0 0.5 -5" width="10" height="5" depth="1"></a-box>
        <a-box static-body="shape: auto" position="0 0.5 4.5" width="10" height="5" depth="1"></a-box>
        <a-box static-body="shape: auto" position="-5.1 0.5 0" rotation="0 90 0" width="10" height="5" depth="1"></a-box>
        <a-box static-body="shape: auto" position="4.5 0.5 0" rotation="0 90 0" width="10" height="5" depth="1"></a-box>
        <a-entity id="camera" position="0 1.6 0">
          <a-entity id="camera" camera look-controls wasd-controls kinematic-body></a-entity>
        </a-entity>
      </a-scene>

      <script>
        // get this data json below from backend      

        var jsonDataArr = [
          '{"objType": "realchair", "src": "./models/armchair.gltf", "jsonData":{"width": "1", "height": "2", "depth": "1", "color": "orange", "x": "2", "y": "0", "z": "-3", "scaleX": "0.00045", "scaleY": "0.00045", "scaleZ": "0.00045", "rotateX": "0", "rotateY": "0", "rotateZ": "0"}}',
          '{"objType": "realchair", "src": "./models/armchair.gltf", "jsonData":{"width": "1", "height": "2", "depth": "1", "color": "blue", "x": "0", "y": "0", "z": "-3", "scaleX": "0.00045", "scaleY": "0.00045", "scaleZ": "0.00045", "rotateX": "0", "rotateY": "0", "rotateZ": "0"}}',
          '{"objType": "realchair", "src": "./models/armchair.gltf", "jsonData":{"width": "1", "height": "2", "depth": "1", "color": "green", "x": "-2", "y": "0", "z": "-3", "scaleX": "0.00045", "scaleY": "0.00045", "scaleZ": "0.00045", "rotateX": "0", "rotateY": "0", "rotateZ": "0"}}',
          '{"objType": "realchair", "src": "./models/sanitizer.gltf", "jsonData":{"width": "1", "height": "2", "depth": "1", "color": "green", "x": "-3.75", "y": "1.5", "z": "-2.5", "scaleX": "0.05", "scaleY": "0.05", "scaleZ": "0.05", "rotateX": "-90", "rotateY": "90", "rotateZ": "0"}}'
        ];

        jsonDataArr.forEach(objCreate);

        function objCreate(backendData, index) {
          var backendDataParsed = JSON.parse(backendData);
          var sceneEl = document.querySelector('a-scene');
          var entityEl = document.createElement('a-entity');

          entityEl.setAttribute('gltf-model', backendDataParsed.src);
          
          entityEl.setAttribute(backendDataParsed.objType, 'jsonData', JSON.stringify(backendDataParsed.jsonData));
          
          sceneEl.appendChild(entityEl);
        }

        // var playerEl = document.querySelector('[camera]');
        //   playerEl.addEventListener('collide', function (e) {
        //     console.log('Player has collided with body #' + e.detail.body.id);

        //     e.detail.target.el;  // Original entity (playerEl).
        //     e.detail.body.el;    // Other entity, which playerEl touched.
        //     e.detail.contact;    // Stats about the collision (CANNON.ContactEquation).
        //     e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).
        //   });
      </script>
  </body>
</html>




